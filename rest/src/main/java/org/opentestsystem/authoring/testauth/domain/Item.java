/*******************************************************************************
 * Educational Online Test Delivery System
 * Copyright (c) 2013 American Institutes for Research
 * 
 * Distributed under the AIR Open Source License, Version 1.0
 * See accompanying file AIR-License-1_0.txt or at
 * http://www.smarterapp.org/documents/American_Institutes_for_Research_Open_Source_Software_License.pdf
 ******************************************************************************/
package org.opentestsystem.authoring.testauth.domain;

import java.io.Serializable;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;

import javax.validation.constraints.NotNull;

import org.springframework.data.mongodb.core.index.CompoundIndex;
import org.springframework.data.mongodb.core.index.CompoundIndexes;
import org.springframework.data.mongodb.core.mapping.Document;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.google.common.collect.Iterables;
import com.google.common.collect.Lists;

@Document
@JsonIgnoreProperties(ignoreUnknown = true)
@CompoundIndexes(value = { @CompoundIndex(name = "assessment_item_indx", def = "{'assessmentId':1, 'tibIdentifier':1}", unique = true) })
public class Item extends AssessmentChild implements Serializable, TenantedByAssessment {

    public static final String NO_GROUP_KEY = "NO_GROUP";

    private static final long serialVersionUID = 2961493317860299590L;

    private List<ItemLocation> itemLocation;

    @NotNull(message = "item.tibIdentifier.required")
    private String tibIdentifier;

    @NotNull(message = "item.version.required")
    private String version;

    @NotNull(message = "item.grade.required")
    private String intendedGrade;

    private String interactionType;
    private String status;
    private String subject;
    private String primaryStandard;
    private String publicationKey;
    private String stimulusName;
    private String associatedStimulus;
    private String associatedTutorial;
    private String associatedWordlist;
    private List<String> enemyList;
    private List<ItemScoreDimension> itemScoreDimensionList;

    private Map<String, Object> allIncludedMetadata;

    public List<ItemLocation> getItemLocation() {
        return this.itemLocation;
    }

    public void setItemLocation(final List<ItemLocation> itemLocationList) {
        this.itemLocation = itemLocationList;
    }

    public List<ItemLocation> getAdaptiveAndFixedItemLocations() {
        if (this.itemLocation == null) {
            return new ArrayList<ItemLocation>();
        }
        return Lists.newArrayList(Iterables.filter(this.itemLocation, ItemLocation.IS_ADAPTIVE_OR_FIXED_LOCATION_FILTER));
    }

    public String getTibIdentifier() {
        return this.tibIdentifier;
    }

    public void setTibIdentifier(final String theTibIdentifier) {
        this.tibIdentifier = theTibIdentifier;
    }

    public String getVersion() {
        return this.version;
    }

    public void setVersion(final String theVersion) {
        this.version = theVersion;
    }

    public String getSubject() {
        return this.subject;
    }

    public void setSubject(final String asubject) {
        this.subject = asubject;
    }

    public String getStatus() {
        return this.status;
    }

    public void setStatus(final String aStatus) {
        this.status = aStatus;
    }

    public String getPrimaryStandard() {
        return this.primaryStandard;
    }

    public void setPrimaryStandard(final String aprimaryStandard) {
        this.primaryStandard = aprimaryStandard;
    }

    public String getPublicationKey() {
        return this.publicationKey;
    }

    public void setPublicationKey(final String apublicationKey) {
        this.publicationKey = apublicationKey;
    }

    public String getStimulusName() {
        return this.stimulusName;
    }

    public void setStimulusName(final String aStimulusName) {
        this.stimulusName = aStimulusName;
    }

    public String getAssociatedStimulus() {
        return this.associatedStimulus;
    }

    public void setAssociatedStimulus(final String anAssociatedStimulus) {
        this.associatedStimulus = anAssociatedStimulus;
    }

    public String getIntendedGrade() {
        return this.intendedGrade;
    }

    public void setIntendedGrade(final String theIntendedGrade) {
        this.intendedGrade = theIntendedGrade;
    }

    public List<String> getEnemyList() {
        return this.enemyList;
    }

    public void setEnemyList(final List<String> aenemyList) {
        this.enemyList = aenemyList;
    }

    public void addItemLocation(final ItemLocation location) {
        if (this.itemLocation == null) {
            this.itemLocation = Lists.newArrayList();
        }
        location.setItemIdentifier(this.tibIdentifier);
        this.itemLocation.add(location);
    }

    public void removeItemLocation(final ItemLocation location) {
        if (this.itemLocation == null) {
            this.itemLocation = Lists.newArrayList();
        }
        location.setItemIdentifier(this.tibIdentifier);
        this.itemLocation.remove(location);
    }

    public Map<String, Object> getAllIncludedMetadata() {
        return this.allIncludedMetadata;
    }

    public void setAllIncludedMetadata(final Map<String, Object> allIncludedMetadataMap) {
        this.allIncludedMetadata = allIncludedMetadataMap;
    }

    public String getInteractionType() {
        return this.interactionType;
    }

    public void setInteractionType(final String interactionType) {
        this.interactionType = interactionType;
    }

    public String getAssociatedTutorial() {
        return this.associatedTutorial;
    }

    public void setAssociatedTutorial(final String associatedTutorial) {
        this.associatedTutorial = associatedTutorial;
    }

    public String getAssociatedWordlist() {
        return this.associatedWordlist;
    }

    public void setAssociatedWordlist(final String associatedWordlist) {
        this.associatedWordlist = associatedWordlist;
    }

    public List<ItemScoreDimension> getItemScoreDimensionList() {
        return this.itemScoreDimensionList;
    }

    public void setItemScoreDimensionList(final List<ItemScoreDimension> itemScoreDimensionList) {
        this.itemScoreDimensionList = itemScoreDimensionList;
    }
}
